$(function(){function a(a,b){var c="";a.forEach(function(a){c=c+'<tr id="'+a.get("id")+'"><td>'+a.get("description")+'</td><td><select class="select-status '+a.get("id")+'"><option value=0'+(0==a.get("status")?" selected":"")+">Pending</option><option value=1"+(1==a.get("status")?" selected":"")+'>Completed</option></select></td><td><button class="delete" data-id="'+a.get("id")+'">Delete</button></td></tr>'}),b.$el.html(c),$(".delete").click(function(a){var b=$(a.currentTarget),c=b.attr("data-id"),d=e.collection,f=d.get(c);d.sync("delete",f),d.remove(c),e.render()}),$(".select-status").on("change",function(a){var b=$(a.currentTarget),c=b.attr("class").replace("select-status","").trim(),d=b.val(),f=e.collection,g=f.get(c);g.set("status",d),f.sync("update",g)})}var b=Backbone.Model.extend({}),c=Backbone.Collection.extend({localStorage:new Backbone.LocalStorage("ToDo")}),d=Backbone.View.extend({el:$("#content"),render:function(){var b=this;if("collection"in this)a(b.collection,b);else{var d=new c;d.fetch({success:function(c){b.collection=c,a(c,b)}})}}}),e=new d;e.render(),$("#submit").click(function(){var a=$("#description");if(""!==a.val()){var c=a.val(),d=0,f=e.collection,g=0;f.forEach(function(a){var b=parseInt(a.get("id"));b>g&&(g=b)}),g+=1;var h=new b({description:c,status:d,id:g});f.push(h),f.sync("create",h),e.render(),a.val("")}else alert("Empty to-do list item not allowed.")})});